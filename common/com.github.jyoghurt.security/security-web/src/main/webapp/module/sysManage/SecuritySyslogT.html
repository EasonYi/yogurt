<!-- Basic Setup Start-->
<div class="panel panel-default wash-clothes-wrapper">
    <div class="panel-heading">
        <h3 class="panel-title">系统日志</h3>

        <div class="panel-options">
            <a href="#" data-toggle="panel">
                <span class="collapse-icon">&ndash;</span>
                <span class="expand-icon">+</span>
            </a>
            <!-- 关闭
                <a href="#" data-toggle="remove">
                &times;
            </a>
            -->
        </div>
    </div>
    <div class="panel-body">
        <table id="table" class="table  table-bordered table-hover" cellspacing="0" width="100%">
            <thead>
            <tr>
                <th></th>
                <th></th>
                <th>操作人</th>
                <th>IP</th>
                <th>模块</th>
                <th width="85px">状态</th>
                <th>内容</th>
                <th>系统</th>
                <th>客户端</th>
                <th>调用时间</th>
                <th width="90px">时长</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
        <script type="text/javascript">

            //            (function ($) {
            //                var param = DF.getUrlParam();
            //                var grid = DF.dataTable({
            //                    id: "table",
            //                    ajax: "securitySyslogT/list?accessSystem="+param.accessSystem,
            //                    searchForm: {
            //                        searchField: {name: 'searchCondition', text: '采购单号/采购人'},
            //                        dateSearchList: [
            //                            {title: '时间', name: 'createDateTime', defaultDate: 'year', dateBtnGroups: true}
            //                        ],
            //                    },
            //                    authorityFn: function () {
            //                        return false;
            //                    },
            //                    columns: [
            //                        {"data": "logId","orderable":false, "visible": false},
            //                        {
            //                            "className": 'details-control',
            //                            "orderable": false,
            //                            "data": null,
            //                            "defaultContent": ''
            //                        },
            //                        {"data": "founderName","orderable":false},
            //                        {"data": "ipAddress","orderable":false},
            //                        {"data": "moduleName","orderable":false},
            //                        {"data": "state","orderable":false},
            //                        {"data": "logMessage","orderable":false},
            //                        {"data": "systemType","orderable":false},
            //                        {"data": "clientType","orderable":false},
            //                        {"data": "createDateTime","orderable":true},
            //                        {"data": "invokeDuration","orderable":true},
            //                    ],
            //                    columnDefs: [
            //                        {
            //                            render: function (data, type, row) {
            //                                return data?"成功":"失败";
            //                            },
            //                            "targets": 5
            //                        }],
            //                    reloadGrid: function () {
            //                        grid.ajax.reload();
            //                    },
            //                    //初始化结束后回调
            //                    initComplete: function () {
            ////                         Add event listener for opening and closing details
            //                        $('#table tbody').on('click', 'td.details-control', function () {
            //                            var tr = $(this).closest('tr');
            //                            var row = grid.row(tr);
            //                            if (row.child.isShown()) {
            //                                // This row is already open - close it
            //                                row.child.hide();
            //                                tr.removeClass('shown');
            //                            }
            //                            else {
            //                                row.child(format(row.data())).show();
            //                                // Open this row
            //                                row.child().css('background','#f5f5f5');
            //                                tr.addClass('shown');
            //                            }
            //                        });
            //                    }
            //                });
            //                function format(d) {
            //                    // `d` is the original data object for the row
            //                    return '<table class="table">' +
            //                        '<tr>' +
            //                        '<td>类及方法:</td>' +
            //                        '<td>' + d.classMethodName + '</td>' +
            //                        '</tr>' +
            //                        '<tr>' +
            //                        '<td>参数:</td>' +
            //                        '<td>' + d.methodParameterValues + '</td>' +
            //                        '</tr>' +
            //                        '<tr>' +
            //                        '<td>异常信息:</td>' +
            //                        '<td>' + (d.errorMessage == null ? '无' : d.errorMessage) + '</td>' +
            //                        '</tr>' +
            //                        '</table>';
            //
            //                }
            //            })(jQuery);
            (function ($) {
                DF.load('js/multipleSearchGrid.js', function () {

                    var param = DF.getUrlParam();
                    var searchConfig = {
                        id: "table",
                        joinColumn: false,
                        ajax: "securitySyslogT/list?accessSystem=" + param.accessSystem,
                        searchForm: {
                            searchField: {name: 'searchCondition', text: '模块/内容'},
                            dateSearchList: [
                                {title: '调用时间', name: 'createDateTime', defaultDate: 'year', dateBtnGroups: true}
                            ],
                            btnSearchList: [
                                {
                                    title: '时长',
                                    name: 'duration',
                                    data: [{dictValueName: '0~10', dictValueCode: '0-10'}, {
                                        dictValueName: '10~30',
                                        dictValueCode: '10-30'
                                    }, {dictValueName: '30~50', dictValueCode: '30-50'}, {
                                        dictValueName: '50~80',
                                        dictValueCode: '50-80'
                                    }, {dictValueName: '80~100', dictValueCode: '80-100'}, {
                                        dictValueName: '100~150',
                                        dictValueCode: '100-150'
                                    }, {dictValueName: '150~200', dictValueCode: '150-200'}, {
                                        dictValueName: '200~300',
                                        dictValueCode: '200-300'
                                    }, {dictValueName: '300~500', dictValueCode: '300-500'}, {
                                        dictValueName: '500以上',
                                        dictValueCode: '500-10000'
                                    }], addAll: '全部'
                                },

                            ],
                        },
                        columns: [
                            {"data": "logId", "orderable": false, "visible": false},
                            {
                                "className": 'details-control',
                                "orderable": false,
                                "data": null,
                                "defaultContent": ''
                            },
                            {"data": "founderName", "orderable": false},
                            {"data": "ipAddress", "orderable": false},
                            {"data": "moduleName", "orderable": false},
                            {"data": "state", "orderable": false},
                            {"data": "logMessage", "orderable": false},
                            {"data": "systemType", "orderable": false},
                            {"data": "clientType", "orderable": false},
                            {"data": "createDateTime", "orderable": true},
                            {"data": "invokeDuration", "orderable": true},
                        ],
                        columnDefs: [
                            {
                                render: function (data, type, row) {
                                    return data ? "成功" : "失败";
                                },
                                "targets": 5
                            }],
                        //重新加载
                        reloadGrid: reloadGrid,
                        //初始化结束后回调
                        initComplete: function () {
                            $('#table tbody').on('click', 'td.details-control', function () {
                                var tr = $(this).closest('tr');
                                var row = grid.row(tr);
                                if (row.child.isShown()) {
                                    // This row is already open - close it
                                    row.child.hide();
                                    tr.removeClass('shown');
                                }
                                else {
                                    row.child(format(row.data())).show();
                                    // Open this row
                                    row.child().css('background', '#f5f5f5');
                                    tr.addClass('shown');
                                }
                            });
                        }
                    }
                    var searchGrid = $('#table').multipleSearchGrid(searchConfig);

                    function reloadGrid() {
                        var grid = searchGrid.getGrid();
                        grid.page(grid.page()).draw(false);
                    }
                });
                function format(d) {
                    // `d` is the original data object for the row
                    return '<table class="table">' +
                        '<tr>' +
                        '<td>类及方法:</td>' +
                        '<td>' + d.classMethodName + '</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td>参数:</td>' +
                        '<td>' + d.methodParameterValues + '</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td>异常信息:</td>' +
                        '<td>' + (d.errorMessage == null ? '无' : d.errorMessage) + '</td>' +
                        '</tr>' +
                        '</table>';

                }
            })(jQuery);
            /* Formatting function for row details - modify as you need */


        </script>
    </div>
</div>


